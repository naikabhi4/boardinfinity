{"version":3,"sources":["Login.js","Player.js","TrackSearchResult.js","Main.js","useAuth.js","App.js","reportWebVitals.js","index.js"],"names":["Login","Container","className","style","minHeight","href","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","TrackSearchResult","track","chooseTrack","cursor","onClick","src","albumUrl","alt","height","width","title","artist","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","window","history","pushState","catch","location","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8af7911c.chunk.js","sourcesContent":["import React from 'react'\r\nimport {Container} from \"react-bootstrap\"\r\n\r\nconst auth_url = \"https://accounts.spotify.com/authorize?client_id=650c755753874c28b47b5169e4fd1bf6&response_type=code&redirect_uri=http://localhost:3000&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\"\r\nfunction Login() {\r\n    return (\r\n      <Container className=\"d-flex justify-content-center align-items-center\"\r\n      style={{ minHeight: \"100vh\" }}>\r\n          <a className=\"btn btn-success btn-lg\" href={auth_url}>\r\n              Log in to Song Library\r\n          </a>\r\n      </Container>\r\n    )\r\n}\r\n\r\nexport default Login\r\n","import { useState, useEffect } from \"react\"\r\nimport SpotifyPlayer from \"react-spotify-web-playback\"\r\n\r\nexport default function Player({ accessToken, trackUri }) {\r\n  const [play, setPlay] = useState(false)\r\n\r\n  useEffect(() => setPlay(true), [trackUri])\r\n\r\n  if (!accessToken) return null\r\n  return (\r\n    <SpotifyPlayer\r\n      token={accessToken}\r\n      showSaveIcon\r\n      callback={state => {\r\n        if (!state.isPlaying) setPlay(false)\r\n      }}\r\n      play={play}\r\n      uris={trackUri ? [trackUri] : []}\r\n    />\r\n  )\r\n}\r\n","import React from \"react\"\r\n\r\nexport default function TrackSearchResult({ track, chooseTrack }) {\r\n  function handlePlay() {\r\n    chooseTrack(track)\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"d-flex m-2 align-items-center\"\r\n      style={{ cursor: \"pointer\" }}\r\n      onClick={handlePlay}\r\n    >\r\n      <img src={track.albumUrl} alt=\"poster\" style={{ height: \"64px\", width: \"64px\" }} />\r\n      <div className=\"ml-3\">\r\n        <div>{track.title}</div>\r\n        <div className=\"text-muted\">{track.artist}</div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useState, useEffect } from \"react\"\r\nimport useAuth from \"./useAuth\"\r\nimport Player from \"./Player\"\r\nimport TrackSearchResult from \"./TrackSearchResult\"\r\nimport { Container, Form } from \"react-bootstrap\"\r\nimport SpotifyWebApi from \"spotify-web-api-node\"\r\nimport axios from \"axios\"\r\n\r\nconst spotifyApi = new SpotifyWebApi({\r\n  clientId: \"8b945ef10ea24755b83ac50cede405a0\",\r\n})\r\n\r\nexport default function Dashboard({ code }) {\r\n  const accessToken = useAuth(code)\r\n  const [search, setSearch] = useState(\"\")\r\n  const [searchResults, setSearchResults] = useState([])\r\n  const [playingTrack, setPlayingTrack] = useState()\r\n  const [lyrics, setLyrics] = useState(\"\")\r\n\r\n  function chooseTrack(track) {\r\n    setPlayingTrack(track)\r\n    setSearch(\"\")\r\n    setLyrics(\"\")\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!playingTrack) return\r\n\r\n    axios\r\n      .get(\"http://localhost:3001/lyrics\", {\r\n        params: {\r\n          track: playingTrack.title,\r\n          artist: playingTrack.artist,\r\n        },\r\n      })\r\n      .then(res => {\r\n        setLyrics(res.data.lyrics)\r\n      })\r\n  }, [playingTrack])\r\n\r\n  useEffect(() => {\r\n    if (!accessToken) return\r\n    spotifyApi.setAccessToken(accessToken)\r\n  }, [accessToken])\r\n\r\n  useEffect(() => {\r\n    if (!search) return setSearchResults([])\r\n    if (!accessToken) return\r\n\r\n    let cancel = false\r\n    spotifyApi.searchTracks(search).then(res => {\r\n      if (cancel) return\r\n      setSearchResults(\r\n        res.body.tracks.items.map(track => {\r\n          const smallestAlbumImage = track.album.images.reduce(\r\n            (smallest, image) => {\r\n              if (image.height < smallest.height) return image\r\n              return smallest\r\n            },\r\n            track.album.images[0]\r\n          )\r\n\r\n          return {\r\n            artist: track.artists[0].name,\r\n            title: track.name,\r\n            uri: track.uri,\r\n            albumUrl: smallestAlbumImage.url,\r\n          }\r\n        })\r\n      )\r\n    })\r\n\r\n    return () => (cancel = true)\r\n  }, [search, accessToken])\r\n\r\n  return (\r\n    <Container className=\"d-flex flex-column py-2\" style={{ height: \"100vh\" }}>\r\n      <Form.Control\r\n        type=\"search\"\r\n        placeholder=\"Search Songs/Artists\"\r\n        value={search}\r\n        onChange={e => setSearch(e.target.value)}\r\n      />\r\n      <div className=\"flex-grow-1 my-2\" style={{ overflowY: \"auto\" }}>\r\n        {searchResults.map(track => (\r\n          <TrackSearchResult\r\n            track={track}\r\n            key={track.uri}\r\n            chooseTrack={chooseTrack}\r\n          />\r\n        ))}\r\n        {searchResults.length === 0 && (\r\n          <div className=\"text-center\" style={{ whiteSpace: \"pre\" }}>\r\n            {lyrics}\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div>\r\n        <Player accessToken={accessToken} trackUri={playingTrack?.uri} />\r\n      </div>\r\n    </Container>\r\n  )\r\n}\r\n","import { useState, useEffect } from \"react\"\r\nimport axios from \"axios\"\r\n\r\nexport default function useAuth(code) {\r\n  const [accessToken, setAccessToken] = useState()\r\n  const [refreshToken, setRefreshToken] = useState()\r\n  const [expiresIn, setExpiresIn] = useState()\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .post(\"http://localhost:3001/login\", {\r\n        code,\r\n      })\r\n      .then(res => {\r\n        setAccessToken(res.data.accessToken)\r\n        setRefreshToken(res.data.refreshToken)\r\n        setExpiresIn(res.data.expiresIn)\r\n        window.history.pushState({}, null, \"/\")\r\n      })\r\n      .catch(() => {\r\n        window.location = \"/\"\r\n      })\r\n  }, [code])\r\n\r\n  useEffect(() => {\r\n    if (!refreshToken || !expiresIn) return\r\n    const interval = setInterval(() => {\r\n      axios\r\n        .post(\"http://localhost:3001/refresh\", {\r\n          refreshToken,\r\n        })\r\n        .then(res => {\r\n          setAccessToken(res.data.accessToken)\r\n          setExpiresIn(res.data.expiresIn)\r\n        })\r\n        .catch(() => {\r\n          window.location = \"/\"\r\n        })\r\n    }, (expiresIn - 60) * 1000)\r\n\r\n    return () => clearInterval(interval)\r\n  }, [refreshToken, expiresIn])\r\n\r\n  return accessToken\r\n}\r\n","import \"bootstrap/dist/css/bootstrap.min.css\"\nimport Login from \"./Login\"\nimport Main from \"./Main\"\n\nconst code = new URLSearchParams(window.location.search).get(\"code\")\n\nfunction App() {\n  return code ? <Main code={code} /> : <Login />\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}